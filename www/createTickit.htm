<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Flippadoo Form Tester</title>
<link href="createTickit_files/style.css" rel="stylesheet" type="text/css">
<link href="createTickit_files/jquery.css" rel="stylesheet" type="text/css">
<script src="createTickit_files/jquery.js"></script>
<script src="createTickit_files/jquery_002.js"></script>
<script src="createTickit_files/tickit.js"></script>
<script>
    
function creatTickitFn() {
    var apiKey = $('#apiKey').val();
	var url = 'http://dev.tickittaskit.com/flippadoo/mobile/tickitService/'+apiKey+'/createTickit';
 	$("#createTickit").attr("action",url);
	$("#createTickit").submit();
}
function loadPage(url) {
    var xmlhttp = new XMLHttpRequest();
    alert("Page request for " + url);
    // Callback function when XMLHttpRequest is ready
    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState === 4) {
            if (xmlhttp.status === 200) {
                document.getElementById('container').innerHTML = xmlhttp.responseText;
            }
        }
    };
    xmlhttp.open("GET", url, true);
    xmlhttp.send();
}

function getLocation() {
           
        var locOptions = {
            timeout: 5000,
            enableHighAccuracy: true
        };
        //get the current location
        navigator.geolocation.getCurrentPosition(onLocationSuccess, onLocationError, locOptions);
        //Clear the current location while we wait for a reading
        

}

function CreateFormTop() {
    var TickitForm ='<div id="container">';
    TickitForm = TickitForm + '<div class="wrapper">  '; 
    TickitForm = TickitForm + '<div class="formContainer">';
    TickitForm = TickitForm + '<form name="createTickit" id="createTickit" action="/flippadoo/mobile/tickitService/createTickit" enctype="multipart/form-data" method="post">  ';            
    TickitForm = TickitForm + '<input name="ownerId" value="1" type="hidden">';
    TickitForm = TickitForm + '<input name="apiKey" id="apiKey" value="355901361" type="hidden">';
    TickitForm = TickitForm + '<input name="ip" value="http://192.168.1.240:8080" type="hidden">     ';          
    TickitForm = TickitForm + '<input name="tickitStatus" value="1" type="hidden">';
    TickitForm = TickitForm + '<input name="tickitType" value="11" type="hidden">   ';            
    TickitForm = TickitForm + '<input value="ChrisHealy@test.com" name="recipient" type="text">';
    TickitForm = TickitForm + '<input value="Whami Location" name="subject" type="text">';
    TickitForm = TickitForm + '<input value="" id="idStartDate" name="startDate" type="text">';
    TickitForm = TickitForm + '<input value="" name="endDate" type="hidden">';    
    document.write(TickitForm);
}

function CreateFormBottom() {
    var TickitForm = '';
    TickitForm = TickitForm + '<input value="" name="tickitFile" type="hidden"> ';
    TickitForm = TickitForm + '<div class="buttonBlock"> ';
    TickitForm = TickitForm + '<button onclick="creatTickitFn();">Whami</button> ';
    TickitForm = TickitForm + '<input type="button" value="Location" onclick="getLocation();"> ';
    TickitForm = TickitForm + '</div> </form></div></div></div>';
    document.write(TickitForm);
}
function onLocationSuccess(loc) {
    
    //alert("onLocationSuccess");    
    //We received something from the API, so first get the
    // timestamp in a date object so we can work with it
    var d = new Date(loc.timestamp);
    //Then replace the page's content with the current
    // location retrieved from the API
    var gpsLocation = loc.coords.latitude + ';' + loc.coords.longitude;
    var HTMLStr = 'Current Location\nLatitude: ' + loc.coords.latitude + '<br /><b>Longitude</b>: ' + loc.coords.longitude + '<br /><b>Altitude</b>: ' + loc.coords.altitude + '<br /><b>Accuracy</b>: ' + loc.coords.accuracy + '<br /><b>Altitude Accuracy</b>: ' + loc.coords.altitudeAccuracy + '<br /><b>Heading</b>: ' + loc.coords.heading + '<br /><b>Speed</b>: ' + loc.coords.speed + '<br /><b>Timestamp</b>: ' + d.toLocaleString();
    
    var TickitForm = '<br><h1>Tickit Form </h1><br><div id="container">';
    TickitForm = TickitForm + '<div class="wrapper">  ';
    TickitForm = TickitForm + '<div class="formContainer">';
    TickitForm = TickitForm + '<form name="createTickit" id="createTickit" action="/flippadoo/mobile/tickitService/createTickit" enctype="multipart/form-data" method="post">  ';
    TickitForm = TickitForm + '<input name="ownerId" value="1" type="hidden">';
    TickitForm = TickitForm + '<input name="apiKey" id="apiKey" value="355901361" type="hidden">';
    TickitForm = TickitForm + '<input name="ip" value="http://192.168.1.240:8080" type="hidden">     ';
    TickitForm = TickitForm + '<input name="tickitStatus" value="1" type="hidden">';
    TickitForm = TickitForm + '<input name="tickitType" value="11" type="hidden">   ';
    TickitForm = TickitForm + '<input value="ChrisHealy@test.com" name="recipient" type="text">';
    TickitForm = TickitForm + '<input value="Whami Location" name="subject" type="text">';
    TickitForm = TickitForm + '<input value="" id="idStartDate" name="startDate" type="text">';
    TickitForm = TickitForm + '<input value="" name="endDate" type="hidden">';
    document.write(TickitForm);
    document.write('<input value="' + gpsLocation + '" name="gps" type="text">');
    document.write('<input value="' + HTMLstr + '" name="msgBody" type="hidden">');
    TickitForm = '';
    TickitForm = TickitForm + '<input value="" name="tickitFile" type="hidden"> ';
    TickitForm = TickitForm + '<div class="buttonBlock"> ';
    TickitForm = TickitForm + '<button onclick="creatTickitFn();">Whami</button> ';
    TickitForm = TickitForm + '<input type="button" value="Location" onclick="getLocation();"> ';
    TickitForm = TickitForm + '</div> </form></div></div></div>';
    document.write(TickitForm);
}

function onLocationError(e) {
    alert("Geolocation error: #" + e.code + "\n" + e.message);
}

</script>
    
</head>

<body onload="getLocation();">
   <!-- the form will load here -->
     
</body>
</html>